<!DOCTYPE html>
<html>
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser.min.js"></script>
</head>
<body>

<script>
    // Define configuration object
    const config = {
        type: Phaser.AUTO,
        width: 800,
        height: 600,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: { y: 300 },
                debug: false // Set to true for debugging physics
            }
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    // Create Phaser game instance
    const game = new Phaser.Game(config);

    let player;
    let cursors;
    let jumpKey;

    // Preload function to load assets
    function preload() {
        this.load.image('terrain', 'images/terrainOne-export.png');
        this.load.atlas('aurielRun', 'images/aruielRun.png', 'images/aruielRun.json');
        this.load.atlas('aurielJump', 'images/aurielJump.png', 'images/aurielJump.json');
        this.load.atlas('aurielBob', 'images/aurielBob.png', 'images/aurielBob.json');
    }

    // Create function to build the level and add character
    function create() {
        // Add terrain blocks
        terrainGroup = this.physics.add.staticGroup(); // Create a group for terrain blocks
        for (let i = -1; i < 6; i++) {
            const terrainBlock = terrainGroup.create(i * 64, 600, 'terrain'); // Adjust Y position
            terrainBlock.setOrigin(0, 1);
            //terrainBlock.setScale(0.5);
        }

        // Add character sprite
        player = this.physics.add.sprite(100, 350, 'player'); // Adjust Y position
        player.setCollideWorldBounds(true);

        // Define running animation
        this.anims.create({
            key: 'run',
            frames: this.anims.generateFrameNames('aurielRun', {
                prefix: 'aruielRun ',
                start: 0,
                end: 3,
                zeroPad: 1,
                suffix: '.aseprite'
            }),
            frameRate: 10,
            repeat: -1
        });

        // Define jump animation
        this.anims.create({
            key: 'jump',
            frames: this.anims.generateFrameNames('aurielJump', {
                prefix: 'aurielJump ',
                start: 0,
                end: 2,
                zeroPad: 1,
                suffix: '.aseprite'
            }),
            frameRate: 10,
            repeat: -1 // Loop indefinitely
        });

        // Define idle animation
        this.anims.create({
            key: 'idle',
            frames: this.anims.generateFrameNames('aurielBob', {
                prefix: 'aurielBob ',
                start: 0,
                end: 1,
                zeroPad: 1,
                suffix: '.aseprite'
            }),
            frameRate: 5,
            repeat: -1 // Loop indefinitely
        });

        // Set the size and offset of the player's physics body
        player.setSize(4, 94); // Set the size to match the player's visible size
        player.setOffset(0, 0); // Set the offset to adjust the collision bounds if needed

        // Enable keyboard input
        cursors = this.input.keyboard.addKeys({
            left: Phaser.Input.Keyboard.KeyCodes.LEFT,
            right: Phaser.Input.Keyboard.KeyCodes.RIGHT,
            a: Phaser.Input.Keyboard.KeyCodes.A,
            d: Phaser.Input.Keyboard.KeyCodes.D
        });

        // Enable space key for jumping
        jumpKey = this.input.keyboard.addKey(Phaser.Input.Keyboard.KeyCodes.SPACE);

        // Enable collisions between player and terrain blocks
        this.physics.add.collider(player, terrainGroup);
    }

    // Update function to handle character movement
    function update() {
        // Reset velocity
        player.setVelocityX(0);

        // Move character left
        if (cursors.left.isDown || cursors.a.isDown) {
            player.setVelocityX(-160);
            player.flipX = true; // Flip character sprite
        }
        // Move character right
        else if (cursors.right.isDown || cursors.d.isDown) {
            player.setVelocityX(160);
            player.flipX = false; // Unflip character sprite
        }

        // Play appropriate animation based on player's state
        if ((cursors.left.isDown || cursors.a.isDown || cursors.right.isDown || cursors.d.isDown) &&
            (player.body.onFloor() || player.body.touching.down)) {
            player.anims.play('run', true);
        } else if (player.body.velocity.y !== 0) {
            player.anims.play('jump', true);
        } else {
            player.anims.play('idle', true);
        }

        // Check if jump key is pressed and player is on the ground
        if (Phaser.Input.Keyboard.JustDown(jumpKey) && (player.body.onFloor() || player.body.touching.down)) {
            player.setVelocityY(-400); // Set vertical velocity to make the player jump
        }
    }
</script>

</body>
</html>

